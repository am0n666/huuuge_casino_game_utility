restore_profile()
{
source `pwd`/.settings
source $SCRIPTS_DIR/kill_game
source $SCRIPTS_DIR/clean
source $TESTS_DIR/if_dir_exists
source $TESTS_DIR/if_file_exists

kill_game

TARGET_DIR=$1
PNAME=$2

BACKUP_FILE_PATH=$TARGET_DIR/$PNAME.tar

TARGET_DIR_PATH=$GAME_DIR

BFE=`if_file_exists $BACKUP_FILE_PATH`
TDE=`if_dir_exists $TARGET_DIR_PATH`

if [ $BFE == 1 ]
then
	if [ $TDE == 1 ]
	then
		cd $TARGET_DIR_PATH
		rm -Rf *
		(pv -n $BACKUP_FILE_PATH | tar xf - -C $TARGET_DIR_PATH ) 2>&1 | dialog --gauge "Przywracanie..." 6 50
		chown -R $GAME_USER:$GAME_USER $GAME_DIR
		clean_cache
		echo $PNAME > $TARGET_DIR/.last_restored
		cd $WORK_DIR
	fi
fi
clear
}

